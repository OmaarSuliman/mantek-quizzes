<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lecture Quizzes</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header id="header">
    <div class="logo">
      <a href="https://mantek-med.vercel.app/">
        <img src="Assets/mantek.svg" alt="Logo">
      </a>
    </div>
    <div class="title">Lecture Quizzes</div>
    <!-- Toggle switch -->
    <label class="toggle-switch">
      <input type="checkbox" id="theme-toggle">
      <span class="slider">
        <span class="icon icon-sun">
          <img src="Assets/sun.svg" alt="Sun">
        </span>
        <span class="icon icon-moon">
          <img src="Assets/moon.svg" alt="Moon">
        </span>
        <span class="knob"></span>
      </span>
    </label>
  </header>
  <main id="menu-container">
    <h2>Select a Subject</h2>
    <div id="subject-dropdown">
      <!-- Subjects and quizzes will be injected here from manifest.json -->
    </div>
  </main>
  <footer>
    &copy; <span id="current-year"></span> khomod inc. All rights reserved.
  </footer>
  <script>
    // Set current year
    document.getElementById('current-year').textContent = new Date().getFullYear();

    // Theme toggle with localStorage
    const themeToggle = document.getElementById('theme-toggle');
    const currentTheme = localStorage.getItem('theme') || 'dark';
    if (currentTheme === 'light') {
      document.body.classList.add('light-mode');
      themeToggle.checked = true;
    }
    themeToggle.addEventListener('change', () => {
      if (themeToggle.checked) {
        document.body.classList.add('light-mode');
        localStorage.setItem('theme', 'light');
      } else {
        document.body.classList.remove('light-mode');
        localStorage.setItem('theme', 'dark');
      }
    });

    // Fetch manifest from data/manifest.json (renamed from subjects.json)
    fetch('data/manifest.json')
      .then(response => response.json())
      .then(subjects => {
        const container = document.getElementById('subject-dropdown');
        subjects.forEach(subject => {
          // Create container for each subject
          const subjectDiv = document.createElement('div');
          subjectDiv.className = 'subject';

          // Subject header (clickable to toggle dropdown)
          const subjectHeader = document.createElement('div');
          subjectHeader.className = 'subject-header';
          subjectHeader.textContent = subject.subject;
          subjectDiv.appendChild(subjectHeader);

          // Container for quizzes under this subject (initially hidden)
          const quizList = document.createElement('div');
          quizList.className = 'quiz-list-container';
          subject.quizzes.forEach(quiz => {
            const quizLink = document.createElement('a');
            quizLink.href = 'quiz.html?file=' + encodeURIComponent(quiz.path);
            quizLink.textContent = quiz.title;
            quizLink.className = 'quiz-link';
            quizList.appendChild(quizLink);
          });
          subjectDiv.appendChild(quizList);
          container.appendChild(subjectDiv);

          // Toggle the quiz list with smooth animation
          subjectHeader.addEventListener('click', () => {
            quizList.classList.toggle('open');
          });
        });
      })
      .catch(error => {
        console.error("Error loading manifest:", error);
        document.getElementById('menu-container').innerHTML = "<p>Error loading subjects.</p>";
      });
  </script>
</body>
</html>